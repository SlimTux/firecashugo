<!DOCTYPE html>
<html class="dark">
  <head>
    <meta charset="utf-8">
    <title>Angular Testing Guide</title>
    <link rel="shortcut icon" href="/img/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="/svelte/index.9e4943d4.css" />
    <script type="module" defer src="/svelte/index.7e2b9467.js" /></script>

    
    <link rel="shortcut icon" href="/img/favicon.png" type="image/x-icon">
    <link rel="apple-touch-icon" type="image/x-icon" href="/img/favicon.png" />
    <meta name="theme-color" content="#454e56">
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <link rel="manifest" href="/manifest.json">
    

 




    <link rel="canonical" href="https://fireship.io/lessons/angular-testing-guide-including-firebase/" />

    <meta name="description" content="Use test-driven development in Angular with Firebase">
    <meta name="image" content="https://fireship.io/lessons/angular-testing-guide-including-firebase/img/featured.png">

    <meta property="og:title" content="Angular Testing Guide" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://fireship.io/lessons/angular-testing-guide-including-firebase/" />
    <meta property="og:image" content="https://fireship.io/lessons/angular-testing-guide-including-firebase/img/featured.png" />
    <meta property="og:description" content="Use test-driven development in Angular with Firebase" />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@fireship_dev">
    <meta name="twitter:title" content="Angular Testing Guide">
    <meta name="twitter:description" content="Use test-driven development in Angular with Firebase">
    <meta name="twitter:image" content="https://fireship.io/lessons/angular-testing-guide-including-firebase/img/featured.png">
    
    <script>
      if ('serviceWorker' in navigator) {
          window.addEventListener('load', () => {
              navigator.serviceWorker.register('/sw.js');
          });
      }
    </script>

  </head>
  <body>
    <global-data 
    permalink="https://fireship.io/lessons/angular-testing-guide-including-firebase/" 
    vimeo=""
    youtube="BumgayeUC08"
    free=""
    next="https://fireship.io/lessons/pwa-performance-optimization-angular/" 
    prev="https://fireship.io/lessons/role-based-authorization-with-firestore-nosql-and-angular-5/">
  </global-data>

    
<nav class="flex justify-between container p-6 md:p-8">
  <a
    class="flex justify-center items-center text-center w-12 h-12 logo-gif"
    href="/"
  >
    <img id="logo" src="/img/logo.svg" alt="logo" />
    <img class="relative bottom-1 left-1" id="logoBg" src="/img/fire.gif" alt="fire background" />
  </a>

  <ul class="flex justify-center items-center">
    <if-pro>
      <li slot="basic" class="mx-2 md:mx-4  hover:scale-105 transition-transform">
        <a href="/pro" class="font-display text-base font-normal text-green-500 border-green-400 border rounded-md px-2 py-1 hover:drop-shadow-[0_0_9px_rgba(34,197,94,0.9)]">PRO</a>
      </li>
    </if-pro>
    <li class="mx-2 md:mx-4 hover:scale-105 transition-transform">
      <a href="/lessons" class="font-sans text-xl font-bold leading-none text-gray2 hover:text-white">Resources</a>
    </li>
    <li class="mx-2 md:mx-4  hover:scale-105 transition-transform">
      <a href="/courses" class="font-sans text-xl font-bold leading-none text-gray2 gradient-slide">Activities</a>
    </li>
    <li class="ml-2">
      <modal-action type="open" name="search">
        <button class="p-2 mr-2 hidden md:flex justify-between items-center bg-white bg-opacity-10 hover:bg-opacity-20 border border-gray4 hover:border-purple-500 
                 shadow-xl hover:drop-shadow-[0_0_7px_rgba(168,85,247,0.5)] transition-all">
          <span class="text-gray2 w-4 mx-2">
<svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="search" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fk-search fk-w-16 fk-9x">
<g class="fk-group"><path fill="currentColor" d="M208 80a128 128 0 1 1-90.51 37.49A127.15 127.15 0 0 1 208 80m0-80C93.12 0 0 93.12 0 208s93.12 208 208 208 208-93.12 208-208S322.88 0 208 0z" class="fk-secondary"></path><path fill="currentColor" d="M504.9 476.7L476.6 505a23.9 23.9 0 0 1-33.9 0L343 405.3a24 24 0 0 1-7-17V372l36-36h16.3a24 24 0 0 1 17 7l99.7 99.7a24.11 24.11 0 0 1-.1 34z" class="fk-primary">
</path></g></svg></span>
          <span class="mr-12">Search</span>
          <span class="mx-2 text-xs border border-gray4 rounded-md p-1 px-2">/</span>
        </button>
        <button class="flex md:hidden">
          <span class="text-gray2 w-6 mx-2">
<svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="search" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fk-search fk-w-16 fk-9x">
<g class="fk-group"><path fill="currentColor" d="M208 80a128 128 0 1 1-90.51 37.49A127.15 127.15 0 0 1 208 80m0-80C93.12 0 0 93.12 0 208s93.12 208 208 208 208-93.12 208-208S322.88 0 208 0z" class="fk-secondary"></path><path fill="currentColor" d="M504.9 476.7L476.6 505a23.9 23.9 0 0 1-33.9 0L343 405.3a24 24 0 0 1-7-17V372l36-36h16.3a24 24 0 0 1 17 7l99.7 99.7a24.11 24.11 0 0 1-.1 34z" class="fk-primary">
</path></g></svg></span>
        </button>
        </modal-action>
      </li>
    <li class="ml-2 mr-6 relative">
      <if-user>
        <a href="/dashboard">
          <user-avatar></user-avatar>
        </a>
        <modal-action slot="signed-out" name="signin" type="open">
          <button class="relative hidden md:inline-block px-4 py-2 text-xl font-display text-black hover:text-white bg-white 
                hover:bg-purple-600 drop-shadow-[6px_6px_0_black] hover:drop-shadow-[0_0_7px_rgba(168,85,247,0.5)] transition-all duration-300">
            login
          </button>
          <button class="flex md:hidden">
            <span class="text-gray2 w-6 mx-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M352 96h64c17.7 0 32 14.3 32 32V384c0 17.7-14.3 32-32 32H352c-17.7 0-32 14.3-32 32s14.3 32 32 32h64c53 0 96-43 96-96V128c0-53-43-96-96-96H352c-17.7 0-32 14.3-32 32s14.3 32 32 32zm-7.5 177.4c4.8-4.5 7.5-10.8 7.5-17.4s-2.7-12.9-7.5-17.4l-144-136c-7-6.6-17.2-8.4-26-4.6s-14.5 12.5-14.5 22v72H32c-17.7 0-32 14.3-32 32v64c0 17.7 14.3 32 32 32H160v72c0 9.6 5.7 18.2 14.5 22s19 2 26-4.6l144-136z"/></svg>
</span>
          </button>
        </modal-action>
      </if-user>
    </li>


  </ul>
</nav>


    
<main class="container">


	<div class="flex w-full justify-between">


		<article itemscope itemtype="http://schema.org/Article" class="w-full">
			<meta itemprop="datePublished" content="2017-11-30 12:37:48 -0700 -0700" />
			<meta itemprop="dateModified" content="2017-11-30 12:37:48 -0700 -0700" />
			<meta itemprop="image" content="img/featured.png" />
			<meta itemprop="publisher" content="fireship.io" />


			<header>

				
				
				<div itemprop="video" itemscope itemtype="http://schema.org/VideoObject">
					<iframe class="w-full aspect-video" src="https://www.youtube.com/embed/BumgayeUC08"
						frameborder="0"
						allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
						allowfullscreen></iframe>

					<meta itemprop="embedUrl" content="https://www.youtube.com/embed/BumgayeUC08" />
					<meta itemprop="thumbnailUrl" content="" />
					<meta itemprop="description" content="Use test-driven development in Angular with Firebase" />
					<meta itemprop="uploadDate" content="2017-11-30 12:37:48 -0700 -0700" />
					<meta itemprop="publisher" content="Fireship" />
				</div>
				

				

				<div class="bg-gray6 py-5 px-3 rounded-lg mb-4 flex justify-between mt-3">

					
					
					<a class="flex items-center no-underline" itemprop="author" name="Jeff Delaney" href="/contributors/jeff-delaney/">
						<img class="w-10 h-10 rounded-full block" src="/contributors/img/jeff-delaney.webp" alt="Jeff Delaney avatar">
						<span class="flex flex-col ml-2">
							<span class="no-underline">By Jeff Delaney</span>
							<span class="text-xs text-gray4">Posted <time itemprop="dateModified">Nov 30, 2017</time>
						</span>
	
					</a>

					
					<span>
						
							<a href="/tags/angular"><span class="tag tag-angular">#angular</span></a>
						
							<a href="/tags/testing"><span class="tag tag-testing">#testing</span></a>
						
							<a href="/tags/firebase"><span class="tag tag-firebase">#firebase</span></a>
						

						
					</span>
					
				
				</div>

			</header>



			
			<section class="prose dark:prose-invert max-w-full lesson-content" itemprop="articleBody">
				


				<h1 itemprop="name headline" id="angular-testing-guide" class="gradient-text">
					Angular Testing Guide
				</h1>


				<p><a href="https://angular.io/guide/testing">Testing your Angular app</a> requires more development effort in the short-term, but can prevent bugs and regressions that will save you time, money, and headache in the long-term.</p>
<p>Testing is the <a href="https://medium.com/javascript-scene/the-shocking-secret-about-static-types-514d39bf30a3">single-most effective tool</a> for preventing software bugs. That&rsquo;s not just my opinion, it is a scientifically proven fact backed by <a href="http://www.sserg.org/publications/uploads/04b700e040d0cac8681ba3d039be87a56020dd41.pdf">empirical studies</a>.</p>
<figure><img src="img/tdd-study.png"/>
</figure>

<p><em>Source: Effects of Test-Driven Development: A
Comparative Analysis of Empirical Studies. Simo Mäkinen and Jürgen Münch. University of Helsinki.</em></p>
<p>Angular uses it&rsquo;s own testing utilities, combined with the popular JavaScript libraries <a href="https://jasmine.github.io/2.4/introduction.html">Jasmine</a> and <a href="https://karma-runner.github.io/1.0/index.html">Karma</a>, to make it easy for developers to test their code.  When frontend JavaScript frameworks first hit the scene, a lack of test-ability was one of their harshest criticisms. Today, testing in Angular is as powerful as any other software development field.</p>
<h2 id="high-level-overview">High Level Overview</h2>
<ul>
<li><strong>Component Tests</strong>: We are going to focus primarily on <a href="https://vsavkin.com/three-ways-to-test-angular-2-components-dcea8e90bd8d">shallow component tests</a>, which render a component&rsquo;s HTML and CSS. We will also test async operations and integrate the component&rsquo;s dependencies, including AngularFire2.</li>
<li><strong>End-to-End</strong>: Also called <em>functional testing</em>, these types of tests will simulate the user experience by running your app through the browser. This allows you to test critical activities, such the user sign-up flow, from start to finish.</li>
</ul>
<figure><img src="img/karama-spec-angular.gif"
         alt="The Karma test runner in Angular"/><figcaption>
            <p>The Karma test runner in Angular</p>
        </figcaption>
</figure>

<h3 id="let-the-cli-handle-boilerplate">Let the CLI handle Boilerplate</h3>
<p>The angular CLI handles virtually all of the boilerplate code required to run tests.  Let&rsquo;s quickly demystify all of the testing boilerplate you would find in a new Angular app.</p>
<ol>
<li><code>karma.conf</code> - Tells Karma <a href="http://karma-runner.github.io/1.0/config/configuration-file.html">how to run your tests</a>.</li>
<li><code>protractor.conf</code> - Tells proteactor how to run end-to-end tests</li>
<li><code>e2e</code> - Your end-to-end tests are kept here</li>
<li><code>src/test.ts</code> - recursively loads all the spec and framework files for testing</li>
<li><code>**.spec.ts</code> - Anything you generate with the CLI includes a spec file where you define the actual tests.</li>
</ol>
<h3 id="anatomy-of-a-jasmine-test-suite">Anatomy of a Jasmine Test Suite</h3>
<p>Testing is really easy - don&rsquo;t overthink it.</p>
<ol>
<li><code>describe</code> what your testing. This is your test <code>suite</code>.</li>
<li><code>it</code> should have some expected behaviors. These are your <code>specs</code>.</li>
<li><code>expect</code> or assert these behaviors to hold true. These are your <code>expectations</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;MyAwesomeComponent&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">beforeEach</span><span class="p">(</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// reproduce the test state
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should be awesome&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">component</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">awesome</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// More specs here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><p>Executing your test suite is as easy as running one of the follow commands:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ng <span class="nb">test</span>
</span></span><span class="line"><span class="cl">ng e2e
</span></span></code></pre></div><p>Angular will re-run your test suite whenever a file changes so you can immediately detect failing code.</p>
<h3 id="what-is-a-test-bed">What is a Test Bed?</h3>
<p>First, we need to learn about concept of a <em>Test Bed</em>. If you&rsquo;re unfamilar with <a href="https://angularfirebase.com/lessons/a-simple-explanation-of-ngmodule/">NgModules</a> at this point, I recommend watching the linked video to get up to speed.</p>
<p>A Test Bed creates an Angular testing module, which is just a class an NgModule class. For example, notice how you have the <code>declarations: [ AlertButtonComponent ]</code> meta data just like any NgModule. This makes it possible to test your components in isolation.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="nx">beforeEach</span><span class="p">(</span><span class="kr">async</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">TestBed</span><span class="p">.</span><span class="nx">configureTestingModule</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">declarations</span><span class="o">:</span> <span class="p">[</span> <span class="nx">AlertButtonComponent</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">compileComponents</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}));</span>
</span></span></code></pre></div><h3 id="what-is-a-fixture">What is a Fixture?</h3>
<p>In TDD, a test fixture creates a repeatable baseline for running tests. The <code>beforeEach</code> method initializes the <code>AlertButtonComponent</code> class in in the same way for each test. In this case, we also want to trigger change detection on the component with <code>detectChanges</code>. You can also trigger other lifecycle hooks here, such as <code>destroy</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fixture</span> <span class="o">=</span> <span class="nx">TestBed</span><span class="p">.</span><span class="nx">createComponent</span><span class="p">(</span><span class="nx">AlertButtonComponent</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">component</span> <span class="o">=</span> <span class="nx">fixture</span><span class="p">.</span><span class="nx">componentInstance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">de</span> <span class="o">=</span> <span class="nx">fixture</span><span class="p">.</span><span class="nx">debugElement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fixture</span><span class="p">.</span><span class="nx">detectChanges</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span></code></pre></div><p>At this point, we have a pattern that can be repeated before each test. Now let&rsquo;s go over some of the most common tests you might need to write for a component.</p>
<h2 id="building-the-component-and-service">Building the Component and Service</h2>
<p>Most of your testing is likely to be conducted in Components. For this demo, I am generating an alert button that will undergo a battery of tests.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="nx">ng</span> <span class="nx">g</span> <span class="nx">component</span> <span class="nx">alert</span><span class="o">-</span><span class="nx">button</span>
</span></span><span class="line"><span class="cl"><span class="nx">ng</span> <span class="nx">g</span> <span class="nx">service</span> <span class="nx">message</span>
</span></span></code></pre></div><p>Now let&rsquo;s build the component. It&rsquo;s nothing more than a button the user can click that will show/hide the button&rsquo;s alert message. I commented out the the Observable data for now, but those lines will be used when we test data that is queried from an API.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;@angular/core&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">MessageService</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;../message.service&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Observable</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;rxjs/Observable&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">timer</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;rxjs/observable/timer&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Component</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">selector</span><span class="o">:</span> <span class="s1">&#39;app-alert-button&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">templateUrl</span><span class="o">:</span> <span class="s1">&#39;./alert-button.component.html&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">styleUrls</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;./alert-button.component.scss&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AlertButtonComponent</span> <span class="kr">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// content: Observable&lt;any&gt;; 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nx">content</span>     <span class="o">=</span> <span class="s1">&#39;you have been warned&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">hideContent</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">severity</span>    <span class="o">=</span> <span class="mi">423</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">constructor</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// constructor(private msgService: MessageService) { }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">ngOnInit() {</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// this.content = this.msgService.getContent();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">toggle() {</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">hideContent</span> <span class="o">=</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">hideContent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">toggleAsync() {</span>
</span></span><span class="line"><span class="cl">    <span class="nx">timer</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">toggle</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="seven-simple-tests">Seven Simple Tests</h2>
<p>Well-written tests can be read and understood by a non-programmer. Jasmine provides a bunch of <a href="https://jasmine.github.io/api/2.6/matchers.html">matchers</a> that help you write expressive tests. Try to make them say exactly how your component should behave - this is the foundation of Behavior Driven Development (BDD).</p>
<h3 id="1-is-something-truthy-or-falsey">1. Is something truthy or falsey?</h3>
<p>Truthy means the item <em>will evalualte to true</em> on a conditional test, it does not have be a primitive <em>true</em>.</p>
<p><code>toBeTruthy()</code> is like saying <code>something == true</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should create&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">component</span><span class="p">).</span><span class="nx">toBeTruthy</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span></code></pre></div><p>Its polar opposite <code>toBeFalsey()</code> is like saying <code>something == false</code>. It will pass for values like <code>false</code>, <code>null</code>, <code>0</code>, <code>undefined</code> and so on.</p>
<h3 id="2-is-something-an-exact-value">2. Is something an exact value?</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should have an severity level of 423&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">severity</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">423</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span></code></pre></div><p>Other useful related matchers include <code>toEqual()</code>, <code>toBeDefined()</code> and <code>toBeNull()</code>.</p>
<h3 id="3-does-something-contain-another-value">3. Does something contain another value?</h3>
<p>You can see if a string contains a substring, or if an array contains a specific element.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should have a message with `warn`&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">content</span><span class="p">).</span><span class="nx">toContain</span><span class="p">(</span><span class="s1">&#39;warn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span></code></pre></div><p>For more complex string matching you can use regex.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should have a message with `warn`&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">message</span><span class="p">).</span><span class="nx">toMatch</span><span class="p">(</span><span class="sr">/string$/</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span></code></pre></div><h3 id="4-does-something-meet-a-logical-condition">4. Does something meet a logical condition?</h3>
<p>Logical tests allow you to make numeric comparisons and work just like operators they describe, i.e. <code>&gt;</code>, <code>&gt;=</code>, and so on.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should have a serverity level greater than 2&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">severity</span><span class="p">).</span><span class="nx">toBeGreaterThan</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span></code></pre></div><h3 id="5-does-a-method-work-as-expected">5. Does a method work as expected?</h3>
<p>The <code>toggleMessage</code> method on the component changes the value of a boolean variable on the component. Many of your tests will combine expectations to simulate how a certain variable reacts to changes.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should toggle the message boolean&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">showMessage</span><span class="p">).</span><span class="nx">toBeFalsy</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">component</span><span class="p">.</span><span class="nx">toggleMessage</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">showMessage</span><span class="p">).</span><span class="nx">toBeTruthy</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span></code></pre></div><h3 id="6-does-a-dom-element-get-rendered-correctly">6. Does a DOM element get rendered correctly?</h3>
<p>The <code>DebugElement</code> makes it possible to query DOM elements in the component tempate to ensure they are rendered properly.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should have an h1 tag of `Alert Button`&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">de</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">By</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)).</span><span class="nx">nativeElement</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Alert Button&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span></code></pre></div><h3 id="7-test-async-operations">7. Test Async Operations</h3>
<p>So far, everything all the tests I&rsquo;ve shown you have been synchronous, but Angular apps rely heavily on async activity. Let&rsquo;s say we add a 500ms RxJS timer when toggling the message visibility.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="c1">// alert-message.component.ts
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">import</span> <span class="p">{</span> <span class="nx">timer</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;rxjs/observable/timer&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// wait 500ms before changing the variable value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">toggleAsync() {</span>
</span></span><span class="line"><span class="cl">    <span class="nx">timer</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">toggle</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><p>We can test this code by running it inside a fake async zone, then using <code>tick()</code> with the number of of milliseconds to simulate the passage of time.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="c1">// Async
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should toggle the message boolean asynchronously&#39;</span><span class="p">,</span> <span class="nx">fakeAsync</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">hideContent</span><span class="p">).</span><span class="nx">toBeTruthy</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">component</span><span class="p">.</span><span class="nx">toggle</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// tick(499); // fails
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">tick</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>   <span class="c1">// passes
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">expect</span><span class="p">(</span><span class="nx">component</span><span class="p">.</span><span class="nx">hideContent</span><span class="p">).</span><span class="nx">toBeFalsy</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}));</span>
</span></span></code></pre></div><p>You can also test the value of contained inside an Observable.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should have message content defined from an observable&#39;</span><span class="p">,</span> <span class="nx">fakeAsync</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">component</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">content</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">expect</span><span class="p">(</span><span class="nx">content</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;You have been warned&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">  <span class="p">}));</span>
</span></span></code></pre></div><p>That&rsquo;s a good start, but there&rsquo;s a lot more to testing. To demonstrate some more advanced testing concepts, let&rsquo;s test our component with an external data source.</p>
<h2 id="how-i-test-data-sources-like-angularfire2">How I Test Data Sources like AngularFire2</h2>
<p>Testing Firebase in Angular can be pretty tricky. The Firebase SDK performs a good deal of magic under the hood that is hard to reproduce as a mock backend. My typical strategy is to use simple stubs and spys that return observables for component unit tests. I also like to use protractor e2e testing as an additional sanity check that the UI works as intended. Let&rsquo;s start with the easiest approach - create a <a href="https://en.wikipedia.org/wiki/Test_stub">stubbed</a> service.</p>
<h3 id="test-an-async-service-with-a-stub">Test an Async Service with a Stub</h3>
<p>Although it&rsquo;s possible to run tests with live data, it is safer and easier to use a stub for testing. The stub will just simulate <a href="https://github.com/angular/angularfire2">AngularFire2</a> by returning an Observable of some testing data.</p>
<p>The important changes are here:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">MessageService</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;../message.service&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="k">of</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;rxjs/observable/of&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">/// ...omitted
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// stub mirrors what AngularFire2 would return from the service
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">beforeEach</span><span class="p">(</span><span class="kr">async</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">serviceStub</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">getContent</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">of</span><span class="p">(</span><span class="s1">&#39;You have been warned&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">TestBed</span><span class="p">.</span><span class="nx">configureTestingModule</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">declarations</span><span class="o">:</span> <span class="p">[</span> <span class="nx">AlertButtonComponent</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nx">providers</span><span class="o">:</span> <span class="p">[</span> <span class="p">{</span> <span class="nx">provide</span>: <span class="kt">MessageService</span><span class="p">,</span> <span class="nx">useValue</span>: <span class="kt">serviceStub</span> <span class="p">}</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">compileComponents</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">/// ...omitted
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should have message content defined from an observable&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">component</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">content</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">expect</span><span class="p">(</span><span class="nx">content</span><span class="p">).</span><span class="nx">toBeDefined</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nx">expect</span><span class="p">(</span><span class="nx">content</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;You have been warned&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span></code></pre></div><p>That spec is not very useful on its own, but you can now use the stubbed data to run tests in your component without making live requests to Firebase.</p>
<h3 id="test-an-async-service-with-a-spy">Test an Async Service with a Spy</h3>
<p>The main drawback with a stub is that you can&rsquo;t keep track of how the method was called or what arguments were passed to it. In certain cases, it can be beneficial to use a spy, which is like a stub, but records how it was called in the test. This allows you to catch problems related to methods being called multiple times or with the wrong arguments. You create spies by using the actual live service, but setting a stubbed return value so a live HTTP request is never made.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">AngularFireModule</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;angularfire2&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">AngularFireDatabaseModule</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;angularfire2/database&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;AlertButtonComponent&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">component</span>: <span class="kt">AlertButtonComponent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">fixture</span>: <span class="kt">ComponentFixture</span><span class="p">&lt;</span><span class="nt">AlertButtonComponent</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">de</span>: <span class="kt">DebugElement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">service</span>: <span class="kt">MessageService</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">spy</span>: <span class="kt">jasmine.Spy</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">beforeEach</span><span class="p">(</span><span class="kr">async</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">TestBed</span><span class="p">.</span><span class="nx">configureTestingModule</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">imports</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="nx">AngularFireModule</span><span class="p">.</span><span class="nx">initializeApp</span><span class="p">(</span><span class="nx">firebaseConfig</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="nx">AngularFireDatabaseModule</span>
</span></span><span class="line"><span class="cl">      <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nx">declarations</span><span class="o">:</span> <span class="p">[</span> <span class="nx">AlertButtonComponent</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nx">providers</span><span class="o">:</span> <span class="p">[</span> <span class="nx">MessageService</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">compileComponents</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl">  <span class="p">}));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fixture</span> <span class="o">=</span> <span class="nx">TestBed</span><span class="p">.</span><span class="nx">createComponent</span><span class="p">(</span><span class="nx">AlertButtonComponent</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">component</span> <span class="o">=</span> <span class="nx">fixture</span><span class="p">.</span><span class="nx">componentInstance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nx">service</span> <span class="o">=</span> <span class="nx">de</span><span class="p">.</span><span class="nx">injector</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="nx">MessageService</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">spy</span> <span class="o">=</span> <span class="nx">spyOn</span><span class="p">(</span><span class="nx">service</span><span class="p">,</span> <span class="s1">&#39;getContent&#39;</span><span class="p">).</span><span class="nx">and</span><span class="p">.</span><span class="nx">returnValue</span><span class="p">(</span><span class="k">of</span><span class="p">(</span><span class="s1">&#39;You have been warned&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">fixture</span><span class="p">.</span><span class="nx">detectChanges</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should call getContent one time and update the view&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">spy</span><span class="p">).</span><span class="nx">toHaveBeenCalled</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span> <span class="nx">spy</span><span class="p">.</span><span class="nx">calls</span><span class="p">.</span><span class="nx">all</span><span class="p">().</span><span class="nx">length</span> <span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">de</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">By</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;.message-body&#39;</span><span class="p">)).</span><span class="nx">nativeElement</span><span class="p">.</span><span class="nx">innerText</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">toContain</span><span class="p">(</span><span class="s1">&#39;warn&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><h2 id="end-to-end-e2e-testing-with-protractor">End-to-End (e2e) Testing with Protractor</h2>
<p>Protractor documentation is limited, but it is the coolest testing tool Angular has to offer in my opinion. Unlike the isolated tests we created in the previous section, it will simulate how an end user experiences your app by running it on a web browser. You can click buttons, fill out forms, and iteract with the app in a very natural way.</p>
<p>When it comes to testing the complex realtime behavior of Firebase, it is often much easier to write e2e tests, rather than try to simulate edge cases with a mock backend. If you go this route, I highly recommend setting up <a href="https://angularfirebase.com/lessons/development-and-production-environments-for-angular-firebase-projects/">separate development and production projects</a> in Firebase so you don&rsquo;t accidentally screw-up all of your live user data.</p>
<figure><img src="img/protractor-spec-angular.gif"/>
</figure>

<h3 id="dealing-with-web-sockets">Dealing with Web Sockets</h3>
<p>Firebase uses websockets to maintain a realtime connection to the server. Protractor sees this as a pending operation that will cause your tests to timeout. There is a community-maintained <a href="https://www.npmjs.com/package/protractor-testability-plugin">plugin</a> that can help prevent this issue for now, but the issue should be resolved in the future.</p>
<p>Install it to dev-dependencies:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">npm install --save-dev protractor-testability-plugin
</span></span></code></pre></div><p>Then add it to <code>protractor.conf.js</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">plugins</span><span class="o">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">package</span><span class="o">:</span> <span class="s1">&#39;protractor-testability-plugin&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}],</span>
</span></span></code></pre></div><h3 id="page-objects-apppots">Page Objects app.po.ts</h3>
<p>The <code>app.po.ts</code> is where you define the actual elements from the DOM that you want to interact with or test. You can grab elements by their CSS class, ID, or tag name, then you can test their content or interact with them.</p>
<p>In this example, we will test the alert message by then clicking its toggle button, then test that it&rsquo;s message was asynchronously populated by AngularFire2.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">browser</span><span class="p">,</span> <span class="nx">by</span><span class="p">,</span> <span class="nx">element</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;protractor&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppPage</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">navigateTo() {</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">browser</span><span class="p">.</span><span class="kr">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">get</span> <span class="nx">title() {</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">element</span><span class="p">(</span><span class="nx">by</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;app-root h1&#39;</span><span class="p">)).</span><span class="nx">getText</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">get</span> <span class="nx">toggleButton() {</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">element</span><span class="p">(</span><span class="nx">by</span><span class="p">.</span><span class="nx">tagName</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">get</span> <span class="nx">alertMessage() {</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">element</span><span class="p">(</span><span class="nx">by</span><span class="p">.</span><span class="nx">className</span><span class="p">(</span><span class="s1">&#39;message-body&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">el</span> <span class="o">?</span> <span class="nx">el</span><span class="p">.</span><span class="nx">getText</span><span class="p">()</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="appe2e-spects">app.e2e-spec.ts</h3>
<p>You can see the Jasmine test format is almost identical to the the unit tests we wrote earlier.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">AppPage</span> <span class="p">}</span> <span class="kr">from</span> <span class="s1">&#39;./app.po&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;My Awesome App&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">page</span>: <span class="kt">AppPage</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">page</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AppPage</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">page</span><span class="p">.</span><span class="nx">navigateTo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should display welcome message&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">page</span><span class="p">.</span><span class="nx">title</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="s1">&#39;Alert Button&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should not display the alert message&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">page</span><span class="p">.</span><span class="nx">alertMessage</span><span class="p">).</span><span class="nx">toBeFalsy</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should display the alert message after clicking toggle button&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">btn</span> <span class="o">=</span> <span class="nx">page</span><span class="p">.</span><span class="nx">toggleButton</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">page</span><span class="p">.</span><span class="nx">alertMessage</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">btn</span><span class="p">).</span><span class="nx">toBeDefined</span><span class="p">();</span>  
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">content</span><span class="p">).</span><span class="nx">toBeFalsy</span><span class="p">();</span>  
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nx">btn</span><span class="p">.</span><span class="nx">click</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">content</span> <span class="o">=</span> <span class="nx">page</span><span class="p">.</span><span class="nx">alertMessage</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expect</span><span class="p">(</span><span class="nx">content</span><span class="p">).</span><span class="nx">toContain</span><span class="p">(</span><span class="s1">&#39;warn&#39;</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><h2 id="the-end">The End</h2>
<p>That&rsquo;s it for component testing basics. Let me know if you have any questions in the comments or chat with me on Slack.</p>


				
			</section>

			<section id="qna" class="my-12 flex flex-col justify-between items-center">
    <h2 class="text-2xl mb-4">Questions? Let's chat</h2>
    <a href="https://discord.gg/SpDdJ3qaKK" class="btn btn-purple btn-lg btn-glow btn-display mx-auto"><span class="w-8 mr-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"/></svg></span> Open Discord</a>
    <div class="mt-3">
        <discord-count></discord-count>
    </div>
</section>

		</article>
		
		
		<aside class="tableOfContents">
			<nav id="TableOfContents">
  <ul>
    <li><a href="#high-level-overview">High Level Overview</a>
      <ul>
        <li><a href="#let-the-cli-handle-boilerplate">Let the CLI handle Boilerplate</a></li>
        <li><a href="#anatomy-of-a-jasmine-test-suite">Anatomy of a Jasmine Test Suite</a></li>
        <li><a href="#what-is-a-test-bed">What is a Test Bed?</a></li>
        <li><a href="#what-is-a-fixture">What is a Fixture?</a></li>
      </ul>
    </li>
    <li><a href="#building-the-component-and-service">Building the Component and Service</a></li>
    <li><a href="#seven-simple-tests">Seven Simple Tests</a>
      <ul>
        <li><a href="#1-is-something-truthy-or-falsey">1. Is something truthy or falsey?</a></li>
        <li><a href="#2-is-something-an-exact-value">2. Is something an exact value?</a></li>
        <li><a href="#3-does-something-contain-another-value">3. Does something contain another value?</a></li>
        <li><a href="#4-does-something-meet-a-logical-condition">4. Does something meet a logical condition?</a></li>
        <li><a href="#5-does-a-method-work-as-expected">5. Does a method work as expected?</a></li>
        <li><a href="#6-does-a-dom-element-get-rendered-correctly">6. Does a DOM element get rendered correctly?</a></li>
        <li><a href="#7-test-async-operations">7. Test Async Operations</a></li>
      </ul>
    </li>
    <li><a href="#how-i-test-data-sources-like-angularfire2">How I Test Data Sources like AngularFire2</a>
      <ul>
        <li><a href="#test-an-async-service-with-a-stub">Test an Async Service with a Stub</a></li>
        <li><a href="#test-an-async-service-with-a-spy">Test an Async Service with a Spy</a></li>
      </ul>
    </li>
    <li><a href="#end-to-end-e2e-testing-with-protractor">End-to-End (e2e) Testing with Protractor</a>
      <ul>
        <li><a href="#dealing-with-web-sockets">Dealing with Web Sockets</a></li>
        <li><a href="#page-objects-apppots">Page Objects app.po.ts</a></li>
        <li><a href="#appe2e-spects">app.e2e-spec.ts</a></li>
      </ul>
    </li>
    <li><a href="#the-end">The End</a></li>
  </ul>
</nav>
		</aside>
		
	</div>


</main>

    
<footer class="container text-center my-6 p-8 text-gray3">
    <div class="mx-auto w-24 h-1 my-12 bg-gradient-to-r from-gray5 to-gray4 rounded-full"></div>
    <div class="pt-10">Find an issue with this page? <a class="text-blue-500" href="https://github.com/fireship-io/fireship.io/tree/master/content/">Fix it on GitHub</a></div>

    <div class="py-3">
        Need help? Email <a href="mailto:henrique.castro.24@colegioplanalto.pt"><strong class="text-white font-bold">School-email</strong></a>
    </div>
    <div class="flex justify-center items-center my-2">
        <a href="https://www.youtube.com/c/Fireship"><i class="w-6 inline-block mx-2"><svg aria-hidden="true" data-prefix="fab" data-icon="youtube" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class="svgyoutube  "><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z" ></path></svg></i></a>
        <a href="https://twitter.com/fireship_dev"><i class="w-6 inline-block mx-2"><svg aria-hidden="true" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svgtwitter  "><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" ></path></svg></i></a>
        <a href="https://github.com/fireship-io"><i class="w-6 inline-block mx-2"><svg aria-hidden="true" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="svggithub "><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" ></path></svg></i></a>
        <a href="https://discord.gg/SpDdJ3qaKK"><i class="w-6 inline-block mx-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"/></svg></i></a>
    </div>

    <h6>Helpful Links</h6>

    <div class="py-3">
        <a href="/courses">Activities</a> | 
        <a href="/lessons">Resources</a> | 
        <a href="/snippets">Snippets</a> | 
        <a href="/tags">Tags</a> | 
        <a href="/contributors">Contrib</a> |
        <a href="/privacy">Privacy</a> | 
        <a href="/terms">Terms</a>
    </div>

    
    <div class="text-xs">
        Copyleft 2023<br> 
    </div>

</footer>




    <app-signin></app-signin>
    <algolia-search></algolia-search>
    <hi-mom></hi-mom>

    <email-handler></email-handler>

    <route-loader>
      <div class="fixed w-full top-0 left-0 h-1 gradient-loader"></div>
    </route-loader>

    <toast-message></toast-message>
    <scroll-up></scroll-up>

    </div>

  </body>
</html>